<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>{% block title %}e-commerce{% endblock %}</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>⚫️</text></svg>">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('css/style.css') }}">
    {% endblock %}

</head>
<body>

<header>
    <nav id="category-nav">
        <a class="category blue" href="{{ path('home') }}">Accueil</a>
        {% include "_partials/_region.html.twig" %}
        <select name="sort">
            <option value="recent">Plus récent</option>
            <option value="cheapest">Moins cher</option>
        </select>
        <a class="category" href="#">Immobilier</a>
        <a class="category" href="#">Véhicules</a>
        {% if app.user %}
        <a class="category red" href="{{ path('dashboard') }}">Mon compte</a>
        <a class="category green" href="{{ path('ad_create') }}">Publier une annonce</a>
        {% else %}
        <a class="category red" href="{{ path('app_login') }}">Se connecter</a>
        <a class="category green" href="{{ path('app_register') }}">Inscription</a>
        {% endif %}

    </nav>
</header>
<div class="padding"></div>

<div class="container">
    {% if app.flashes('success') is not empty %}
        <div class="content green">
            {% for flashMessage in app.flashes('success') %}
                Flash Message Success: {{ flashMessage }}
            {% endfor %}
        </div>
    {% endif %}

    {% if app.flashes('error') is not empty %}
        <div class="content red">
            {% for flashMessage in app.flashes('error') %}
                Flash Message Error: {{ flashMessage }}
            {% endfor %}
        </div>
    {% endif %}
    {% block body %}{% endblock %}

</div>

<div class="padding"></div>

<footer>Chat</footer>

<script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    {% block javascripts %}
    <script src="{{ asset('app.js') }}"></script>
    {% endblock %}
<script>
    // Get the parent nav element
    const categoryNav = document.getElementById('category-nav');

    // Function to handle the click event on the parent nav
    function handleCategoryClick(event) {
        // Check if the click occurred on a category link
        if (event.target.classList.contains('category')) {
            // Prevent the default link behavior
            event.preventDefault();

            // Remove the "active" class from all category links
            const categoryLinks = categoryNav.querySelectorAll('.category');
            categoryLinks.forEach(link => link.classList.remove('active'));

            // Add the "active" class to the clicked category link
            event.target.classList.add('active');

            // Save the active category link in local storage
            localStorage.setItem('activeCategory', event.target.getAttribute('href'));

            // Perform any additional actions here, like navigating to the link's href
            window.location.href = event.target.href;
        }
    }

    // Add click event listener to the parent nav
    categoryNav.addEventListener('click', handleCategoryClick);

    // Restore the active category link from local storage on page load
    document.addEventListener('DOMContentLoaded', () => {
        const activeCategory = localStorage.getItem('activeCategory');
        if (activeCategory) {
            // Add the "active" class to the corresponding category link
            const categoryLinks = categoryNav.querySelectorAll('.category');
            categoryLinks.forEach(link => {
                if (link.getAttribute('href') === activeCategory) {
                    link.classList.add('active');
                }
            });
        }
    });
</script>

</body>
</html>
